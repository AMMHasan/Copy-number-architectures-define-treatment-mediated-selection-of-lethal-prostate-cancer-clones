{
    "type": [
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        2
    ],
    "data": [
        "  colSums(na.rm = T) %>% ",
        "+ ",
        "  reshape2::melt() %>% ",
        "+ ",
        "  dplyr::select(AR_score=value) %>% ",
        "+ ",
        "  dplyr::mutate(sample_ID=rownames(.))",
        "> ",
        "plot_data <- dplyr::left_join(meta_data_RNAseq,exprMat_AR_score,  by=\"sample_ID\") %>%",
        "+ ",
        "  dplyr::left_join(., ",
        "+ ",
        "            exprMat_norm_scaled[\"AR\",] %>% ",
        "+ ",
        "              t() %>% ",
        "+ ",
        "              data.frame() %>% ",
        "+ ",
        "              dplyr::mutate(sample_ID=rownames(.)), ",
        "+ ",
        "            by=\"sample_ID\"",
        "+ ",
        "            ) %>% ",
        "+ ",
        "  dplyr::filter(TC >= 0.2)",
        "> ",
        "ggplot2::ggplot(data = plot_data, ",
        "+ ",
        "                ggplot2::aes( x = AR, y = AR_score)) + ",
        "+ ",
        "  ggplot2::geom_point(pch = 21, ggplot2::aes(fill = patient_ID, size = AR_copy_number_ACE)) +",
        "+ ",
        "  ggplot2::geom_smooth(method = \"lm\", se=F, ggplot2::aes(colour = patient_ID), show.legend = F) +",
        "+ ",
        "  ggplot2::labs(x=\"Normalized AR expression\",",
        "+ ",
        "       y=\"AR score\",size = \"AR CN\", fill = \"patient ID\") +",
        "+ ",
        "  ggplot2::theme_bw()",
        "\u001B[38;5;255m`geom_smooth()` using formula = 'y ~ x'\u001B[39m\n",
        "> ",
        "plot_data %>% ",
        "+ ",
        "  dplyr::group_by(patient_ID) %>% ",
        "+ ",
        "  tidyr::nest() %>% ",
        "+ ",
        "  dplyr::mutate(model = purrr::map(.x=data, .f = ~cor.test(.x$AR_score, .x$AR)),",
        "+ ",
        "         tidied = purrr::map(model, .f=broom::tidy)) %>% ",
        "+ ",
        "  tidyr::unnest(tidied) %>% ",
        "+ ",
        "  dplyr::arrange(patient_ID) %>% ",
        "+ ",
        "  dplyr::select(patient_ID, estimate, p.value)",
        "\u001B[38;5;246m# A tibble: 4 × 3\u001B[39m\n\u001B[38;5;246m# Groups:   patient_ID [4]\u001B[39m\n  patient_ID estimate p.value\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m   \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m CA63         0.499  0.208  \n\u001B[38;5;250m2\u001B[39m CA76         0.312  0.452  \n\u001B[38;5;250m3\u001B[39m CA83         0.095\u001B[4m5\u001B[24m 0.904  \n\u001B[38;5;250m4\u001B[39m PEA172       0.626  0.003\u001B[4m1\u001B[24m\u001B[4m3\u001B[24m\n",
        "> ",
        "save.image(\"~/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "styler:::set_style_transformers()",
        "Warning messages:\n",
        "1: ",
        "In normalizePath(tools::R_user_dir(\"R.cache\", which = \"cache\")) :",
        "\n ",
        " path[1]=\"/Users/mahedi/Library/Caches/org.R-project.R/R/R.cache\": No such file or directory\n",
        "2: ",
        "In normalizePath(tools::R_user_dir(\"R.cache\", which = \"cache\")) :",
        "\n ",
        " path[1]=\"/Users/mahedi/Library/Caches/org.R-project.R/R/R.cache\": No such file or directory\n",
        "3: ",
        "In normalizePath(tools::R_user_dir(\"R.cache\", which = \"cache\")) :",
        "\n ",
        " path[1]=\"/Users/mahedi/Library/Caches/org.R-project.R/R/R.cache\": No such file or directory\n",
        "> ",
        "styler:::style_selection()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_selection()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_selection()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_selection()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_selection()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n",
        "> ",
        "styler:::style_active_file()",
        "Using style transformers `styler::tidyverse_style()`\n\nRestarting R session...\n\n",
        "> ",
        "# load data:",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "# set the color palette:",
        "> ",
        "cbPalette <- c(",
        "+ ",
        "  \"#999999\",",
        "+ ",
        "  \"#E69F00\",",
        "+ ",
        "  \"#56B4E9\",",
        "+ ",
        "  \"#009E73\",",
        "+ ",
        "  \"#F0E442\",",
        "+ ",
        "  \"#0072B2\",",
        "+ ",
        "  \"#D55E00\",",
        "+ ",
        "  \"#CC79A7\"",
        "+ ",
        ")",
        "> ",
        "data <- data_fig3a %>%",
        "+ ",
        "  dplyr::mutate(yAdj = dplyr::case_when(",
        "+ ",
        "    Type == \"BND\" ~ 0.5,",
        "+ ",
        "    Type == \"DUP\" ~ 0.4,",
        "+ ",
        "    Type == \"INV\" ~ 0.3,",
        "+ ",
        "    Type == \"DEL\" ~ 0.2",
        "+ ",
        "  ))",
        "> ",
        "ggplot2::ggplot(data, ggplot2::aes(start, yCoord, colour = Type)) +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66774465, xmax = 66950461, ymin = 0.5, ymax = 25.5, alpha = 0.5, fill = \"salmon\") +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66117800, xmax = 66128800, ymin = 0.5, ymax = 25.5, fill = \"black\") +",
        "+ ",
        "  ggplot2::geom_point(shape = 73, size = 5) +",
        "+ ",
        "  ggplot2::geom_hline(yintercept = c(0.5, data$yCoord + 0.5), colour = \"grey\", linetype = 2, linewidth = 0.3) +",
        "+ ",
        "  ggplot2::scale_colour_manual(values = cbPalette) +",
        "+ ",
        "  ggplot2::scale_x_continuous(",
        "+ ",
        "    name = \"Chromosome X position (Mb)\",",
        "+ ",
        "    limits = c(4.3e7, 8e7),",
        "+ ",
        "    breaks = seq(50e6, 80e6, 1e6),",
        "+ ",
        "    labels = as.character(seq(50, 80))",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::annotate(\"text\", x = 4.4e7, y = data$yCoord, label = data$met, hjust = \"left\") +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::theme(",
        "+ ",
        "    axis.title.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.text.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.ticks.y = ggplot2::element_blank()",
        "+ ",
        "  )",
        "Warning messages:\n",
        "1: \u001B[38;5;255mRemoved 2 rows containing missing values (`geom_point()`).\u001B[39m \n",
        "2: \u001B[38;5;255mRemoved 96 rows containing missing values (`geom_text()`).\u001B[39m \n",
        "> ",
        "",
        "> ",
        "ggplot2::ggplot(data, ggplot2::aes(start, yCoord, colour = Type)) +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66774465, xmax = 66950461, ymin = 0.5, ymax = 25.5, alpha = 0.5, fill = \"salmon\") +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66117800, xmax = 66128800, ymin = 0.5, ymax = 25.5, fill = \"black\") +",
        "+ ",
        "  ggplot2::geom_point(shape = 73, size = 5) +",
        "+ ",
        "  ggplot2::geom_hline(yintercept = c(0.5, data$yCoord + 0.5), colour = \"grey\", linetype = 2, linewidth = 0.3) +",
        "+ ",
        "  ggplot2::scale_colour_manual(values = cbPalette) +",
        "+ ",
        "  ggplot2::scale_x_continuous(",
        "+ ",
        "    name = \"Chromosome X position (Mb)\",",
        "+ ",
        "    limits = c(4.3e7, 8e7),",
        "+ ",
        "    breaks = seq(50e6, 80e6, 1e6),",
        "+ ",
        "    labels = as.character(seq(50, 80))",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::annotate(\"text\", x = 4.4e7, y = data$yCoord, label = data$met, hjust = \"left\") +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::theme(",
        "+ ",
        "    axis.title.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.text.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.ticks.y = ggplot2::element_blank()",
        "+ ",
        "  )",
        "Warning messages:\n",
        "1: \u001B[38;5;255mRemoved 2 rows containing missing values\n(`geom_point()`).\u001B[39m \n",
        "2: \u001B[38;5;255mRemoved 96 rows containing missing values\n(`geom_text()`).\u001B[39m \n",
        "> ",
        "# load data:",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "# calculating CCF",
        "> ",
        "data_fig3b %>% dplyr::mutate(",
        "+ ",
        "  AF = var_read_number / (var_read_number + ref_read_number),",
        "+ ",
        "  adjusted_AF = AF / TC,",
        "+ ",
        "  u = adjusted_AF * ((TC * T_CCN) + ((1 - TC) * N_CCN)),",
        "+ ",
        "  m = dplyr::case_when(",
        "+ ",
        "    u >= 1 ~ abs(u),",
        "+ ",
        "    u < 1 ~ 1",
        "+ ",
        "  ),",
        "+ ",
        "  CCF = u / m,",
        "+ ",
        "  comment = dplyr::case_when(",
        "+ ",
        "    CCF == 1 ~ \"Clonal\",",
        "+ ",
        "    CCF == 0 ~ \"NA\",",
        "+ ",
        "    CCF < 1 ~ \"Subclonal\"",
        "+ ",
        "  )",
        "+ ",
        ")",
        "   SampleID met.number.on.figure Chromosome    Start\n1  CA34_327                    1          X 47479091\n2  CA34_327                    1          X 64551678\n3  CA34_327                    1          X 65320168\n4  CA34_327                    1          X 65344221\n5  CA34_327                    1          X 66294718\n6  CA34_327                    1          X 67082593\n7  CA34_327                    1         21 39967146\n8  CA34_328                    3          X 47479091\n9  CA34_328                    3          X",
        " 64551678\n10 CA34_328                    3          X 65320168\n11 CA34_328                    3          X 65344221\n12 CA34_328                    3          X 66294718\n13 CA34_328                    3          X 67082593\n14 CA34_328                    3         21 39967146\n15 CA34_329                    2          X 47479091\n16 CA34_329                    2          X 64551678\n17 CA34_329                    2          X 65320168\n18 CA34_329                    2          X 65344221\n19 CA34_329                    2",
        "          X 66294718\n20 CA34_329                    2          X 67082593\n21 CA34_329                    2         21 39967146\n22 CA34_330                   13          X 47479091\n23 CA34_330                   13          X 64551678\n24 CA34_330                   13          X 65320168\n25 CA34_330                   13          X 65344221\n26 CA34_330                   13          X 66294718\n27 CA34_330                   13          X 67082593\n28 CA34_330                   13         21 39967146\n29 CA34_331                    4",
        "          X 47479091\n30 CA34_331                    4          X 64551678\n31 CA34_331                    4          X 65320168\n32 CA34_331                    4          X 65344221\n33 CA34_331                    4          X 66294718\n34 CA34_331                    4          X 67082593\n35 CA34_331                    4         21 39967146\n36 CA34_334                    5          X 47479091\n37 CA34_334                    5          X 64551678\n38 CA34_334                    5          X 65320168\n39 CA34_334                    5",
        "          X 65344221\n40 CA34_334                    5          X 66294718\n41 CA34_334                    5          X 67082593\n42 CA34_334                    5         21 39967146\n43 CA34_335                    6          X 47479091\n44 CA34_335                    6          X 64551678\n45 CA34_335                    6          X 65320168\n46 CA34_335                    6          X 65344221\n47 CA34_335                    6          X 66294718\n48 CA34_335                    6          X 67082593\n49 CA34_335                    6",
        "         21 39967146\n50 CA34_336                    7          X 47479091\n51 CA34_336                    7          X 64551678\n52 CA34_336                    7          X 65320168\n53 CA34_336                    7          X 65344221\n54 CA34_336                    7          X 66294718\n55 CA34_336                    7          X 67082593\n56 CA34_336                    7         21 39967146\n57 CA34_338                   11          X 47479084\n58 CA34_338                   11          X 64551678\n        End SV_type",
        " ref_read_number var_read_number\n1  67374569     INV             983               3\n2  64552764     INV             967              45\n3  65323397     INV             348               0\n4  65563086     DUP            1101               7\n5  66487681     DUP            5239               9\n6  67085253     DEL            5959              10\n7  42874155     DEL            1755              65\n8  67374569     INV             950               2\n9  64552764     INV             602              12\n10 65323397",
        "     INV             226               0\n11 65563086     DUP             648               2\n12 66487681     DUP            3199               3\n13 67085253     DEL            2905               4\n14 42874155     DEL             638             152\n15 67374569     INV             291               1\n16 64552764     INV             288               0\n17 65323397     INV             120               0\n18 65563086     DUP             364               1\n19 66487681     DUP             537               0\n20 67085253",
        "     DEL             449               0\n21 42874155     DEL             894              36\n22 67374569     INV            1203               0\n23 64552764     INV             348               0\n24 65323397     INV             109               0\n25 65563086     DUP             291               0\n26 66487681     DUP            3423               0\n27 67085253     DEL            3834               0\n28 42874155     DEL             622             113\n29 67374569     INV             286              16\n30 64552764",
        "     INV             239             111\n31 65323397     INV             151               6\n32 65563086     DUP             354              23\n33 66487681     DUP             868              31\n34 67085253     DEL             359              70\n35 42874155     DEL             576              22\n36 67374569     INV            1343             401\n37 64552764     INV            1206            2621\n38 65323397     INV            1400             139\n39 65563086     DUP            4269             550\n40 66487681",
        "     DUP            9407             618\n41 67085253     DEL            3439            1134\n42 42874155     DEL             915             283\n43 67374569     INV            1865             395\n44 64552764     INV            1506            2745\n45 65323397     INV            1709             176\n46 65563086     DUP            4827             691\n47 66487681     DUP           11115             810\n48 67085253     DEL            2070             564\n49 42874155     DEL            1275             332\n50 67374569",
        "     INV             589              95\n51 64552764     INV             481             899\n52 65323397     INV             618              72\n53 65563086     DUP            1679             191\n54 66487681     DUP            4463             285\n55 67085253     DEL            1287             383\n56 42874155     DEL             353              90\n57 67374568     INV             796             233\n58 64552764     INV             527            1216\n      TC T_CCN N_CCN           AF adjusted_AF\n1  0.075     0",
        "     1 0.0030425963 0.040567951\n2  0.075     0     1 0.0444664032 0.592885375\n3  0.075     0     1 0.0000000000 0.000000000\n4  0.075     0     1 0.0063176895 0.084235860\n5  0.075     0     1 0.0017149390 0.022865854\n6  0.075     0     1 0.0016753225 0.022337633\n7  0.075     3     2 0.0357142857 0.476190476\n8  0.375     1     1 0.0021008403 0.005602241\n9  0.375     1     1 0.0195439739 0.052117264\n10 0.375     1     1 0.0000000000 0.000000000\n11 0.375     1     1 0.0030769231 0.008205128\n12 0.375    25     1",
        " 0.0009369144 0.002498438\n13 0.375    25     1 0.0013750430 0.003666781\n14 0.375     2     2 0.1924050633 0.513080169\n15 0.055     0     1 0.0034246575 0.062266501\n16 0.055     0     1 0.0000000000 0.000000000\n17 0.055     4     1 0.0000000000 0.000000000\n18 0.055     4     1 0.0027397260 0.049813200\n19 0.055     4     1 0.0000000000 0.000000000\n20 0.055     4     1 0.0000000000 0.000000000\n21 0.055     2     2 0.0387096774 0.703812317\n22 0.540     1     1 0.0000000000 0.000000000\n23 0.540     1     1 0.0000000000",
        " 0.000000000\n24 0.540     1     1 0.0000000000 0.000000000\n25 0.540     1     1 0.0000000000 0.000000000\n26 0.540    25     1 0.0000000000 0.000000000\n27 0.540    25     1 0.0000000000 0.000000000\n28 0.540     2     2 0.1537414966 0.284706475\n29 0.055     0     1 0.0529801325 0.963275135\n30 0.055     5     1 0.3171428571 5.766233766\n31 0.055     5     1 0.0382165605 0.694846555\n32 0.055     5     1 0.0610079576 1.109235592\n33 0.055     5     1 0.0344827586 0.626959248\n34 0.055     5     1 0.1631701632 2.966730239",
        "\n35 0.055     3     2 0.0367892977 0.668896321\n36 0.840     9     1 0.2299311927 0.273727610\n37 0.840     9     1 0.6848706559 0.815322209\n38 0.840     9     1 0.0903183886 0.107521891\n39 0.840     9     1 0.1141315626 0.135870908\n40 0.840     9     1 0.0616458853 0.073387959\n41 0.840     9     1 0.2479772578 0.295211021\n42 0.840     4     2 0.2362270451 0.281222673\n43 0.520     1     1 0.1747787611 0.336113002\n44 0.520    25     1 0.6457304164 1.241789262\n45 0.520    25     1 0.0933687003 0.179555193\n46 0.520",
        "    25     1 0.1252265314 0.240820253\n47 0.520    25     1 0.0679245283 0.130624093\n48 0.520    25     1 0.2141230068 0.411775013\n49 0.520     4     2 0.2065961419 0.397300273\n50 0.540     1     1 0.1388888889 0.257201646\n51 0.540     4     1 0.6514492754 1.206387547\n52 0.540    26     1 0.1043478261 0.193236715\n53 0.540    26     1 0.1021390374 0.189146366\n54 0.540    26     1 0.0600252738 0.111157914\n55 0.540    26     1 0.2293413174 0.424706143\n56 0.540     4     2 0.2031602709 0.376222724\n57 0.730     2",
        "     1 0.2264334305 0.310182782\n58 0.730     9     1 0.6976477338 0.955681827\n              u         m         CCF   comment\n1   0.037525355  1.000000 0.037525355 Subclonal\n2   0.548418972  1.000000 0.548418972 Subclonal\n3   0.000000000  1.000000 0.000000000        NA\n4   0.077918171  1.000000 0.077918171 Subclonal\n5   0.021150915  1.000000 0.021150915 Subclonal\n6   0.020662311  1.000000 0.020662311 Subclonal\n7   0.988095238  1.000000 0.988095238 Subclonal\n8   0.005602241  1.000000 0.005602241 Subclonal\n9 ",
        "  0.052117264  1.000000 0.052117264 Subclonal\n10  0.000000000  1.000000 0.000000000        NA\n11  0.008205128  1.000000 0.008205128 Subclonal\n12  0.024984385  1.000000 0.024984385 Subclonal\n13  0.036667813  1.000000 0.036667813 Subclonal\n14  1.026160338  1.026160 1.000000000    Clonal\n15  0.058841843  1.000000 0.058841843 Subclonal\n16  0.000000000  1.000000 0.000000000        NA\n17  0.000000000  1.000000 0.000000000        NA\n18  0.058032379  1.000000 0.058032379 Subclonal\n19  0.000000000  1.000000 0.000000000",
        "        NA\n20  0.000000000  1.000000 0.000000000        NA\n21  1.407624633  1.407625 1.000000000    Clonal\n22  0.000000000  1.000000 0.000000000        NA\n23  0.000000000  1.000000 0.000000000        NA\n24  0.000000000  1.000000 0.000000000        NA\n25  0.000000000  1.000000 0.000000000        NA\n26  0.000000000  1.000000 0.000000000        NA\n27  0.000000000  1.000000 0.000000000        NA\n28  0.569412950  1.000000 0.569412950 Subclonal\n29  0.910295003  1.000000 0.910295003 Subclonal\n30  7.034805195  7.034805",
        " 1.000000000    Clonal\n31  0.847712797  1.000000 0.847712797 Subclonal\n32  1.353267422  1.353267 1.000000000    Clonal\n33  0.764890282  1.000000 0.764890282 Subclonal\n34  3.619410892  3.619411 1.000000000    Clonal\n35  1.374581940  1.374582 1.000000000    Clonal\n36  2.113177152  2.113177 1.000000000    Clonal\n37  6.294287456  6.294287 1.000000000    Clonal\n38  0.830069000  1.000000 0.830069000 Subclonal\n39  1.048923408  1.048923 1.000000000    Clonal\n40  0.566555041  1.000000 0.566555041 Subclonal\n41  2.279029084",
        "  2.279029 1.000000000    Clonal\n42  1.034899436  1.034899 1.000000000    Clonal\n43  0.336113002  1.000000 0.336113002 Subclonal\n44 16.739319255 16.739319 1.000000000    Clonal\n45  2.420403999  2.420404 1.000000000    Clonal\n46  3.246257005  3.246257 1.000000000    Clonal\n47  1.760812772  1.760813 1.000000000    Clonal\n48  5.550727177  5.550727 1.000000000    Clonal\n49  1.207792829  1.207793 1.000000000    Clonal\n50  0.257201646  1.000000 0.257201646 Subclonal\n51  3.160735373  3.160735 1.000000000    Clonal",
        "\n52  2.801932367  2.801932 1.000000000    Clonal\n53  2.742622301  2.742622 1.000000000    Clonal\n54  1.611789759  1.611790 1.000000000    Clonal\n55  6.158239077  6.158239 1.000000000    Clonal\n56  1.158765989  1.158766 1.000000000    Clonal\n57  0.536616212  1.000000 0.536616212 Subclonal\n58  6.536863697  6.536864 1.000000000    Clonal\n [ reached 'max' / getOption(\"max.print\") -- omitted 19 rows ]\n",
        "> ",
        "",
        "> ",
        "# library(dplyr)",
        "> ",
        "",
        "> ",
        "# load data:",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "# calculating CCF:",
        "> ",
        "data_fig3c %>% dplyr::mutate(",
        "+ ",
        "  AF = var_read_number / (var_read_number + ref_read_number),",
        "+ ",
        "  adjusted_AF = AF / TC,",
        "+ ",
        "  u = adjusted_AF * ((TC * T_CCN) + ((1 - TC) * N_CCN)),",
        "+ ",
        "  m = dplyr::case_when(",
        "+ ",
        "    u >= 1 ~ abs(u),",
        "+ ",
        "    u < 1 ~ 1",
        "+ ",
        "  ),",
        "+ ",
        "  CCF = u / m,",
        "+ ",
        "  comment = dplyr::case_when(",
        "+ ",
        "    CCF == 1 ~ \"Clonal\",",
        "+ ",
        "    CCF == 0 ~ \"NA\",",
        "+ ",
        "    CCF < 1 ~ \"Subclonal\"",
        "+ ",
        "  )",
        "+ ",
        ")",
        "   SampleID met.number.on.figure chromosome    start\n1  CA27_214                   13          X 66933049\n2  CA27_215                   14          X 66933049\n3  CA27_216                    7          X 66933049\n4  CA27_217                    8          X 66933049\n5  CA27_218                    9          X 66933049\n6  CA27_219                   10          X 66933049\n7  CA27_220                   16          X 66933049\n8  CA27_221                    1          X 66933049\n9  CA27_222                    2          X",
        " 66933049\n10 CA27_223                    3          X 66933049\n11 CA27_224                    4          X 66933049\n12 CA27_225                    5          X 66933049\n13 CA27_226                   11          X 66933049\n14 CA27_227                   12          X 66933049\n15 CA27_228                   17          X 66933049\n16 CA27_229                    6          X 66933049\n17 CA27_231                   15          X 66933049\n        end SV.type ref_read_number var_read_number\n1  66942735     INV             351",
        "              82\n2  66942735     INV             359             299\n3  66942735     INV             378              65\n4  66942735     INV             434             277\n5  66942735     INV             589             327\n6  66942735     INV             934             290\n7  66942735     INV             742             413\n8  66942735     INV             395               3\n9  66942735     INV             504               0\n10 66942735     INV             915               0\n11 66942735     INV             423",
        "              24\n12 66942735     INV            1273              32\n13 66942735     INV             621             497\n14 66942735     INV             578               8\n15 66942735     INV             445             147\n16 66942735     INV             255             126\n17 66942735     INV             654             132\n     TC T_CCN N_CCN          AF adjusted_AF          u\n1  0.60     1     1 0.189376443  0.31562741 0.31562741\n2  0.58     1     1 0.454407295  0.78346085 0.78346085\n3  0.41     1     1",
        " 0.146726862  0.35787040 0.35787040\n4  0.55     1     1 0.389592124  0.70834932 0.70834932\n5  0.53     1     1 0.356986900  0.67356019 0.67356019\n6  0.49     1     1 0.236928105  0.48352674 0.48352674\n7  0.57     1     1 0.357575758  0.62732589 0.62732589\n8  0.43     1     1 0.007537688  0.01752951 0.01752951\n9  0.56     1     1 0.000000000  0.00000000 0.00000000\n10 0.14     1     1 0.000000000  0.00000000 0.00000000\n11 0.44     1     1 0.053691275  0.12202563 0.12202563\n12 0.13     1     1 0.024521073  0.18862364",
        " 0.18862364\n13 0.85     2     1 0.444543828  0.52299274 0.96753657\n14 0.79     1     1 0.013651877  0.01728086 0.01728086\n15 0.48     1     1 0.248310811  0.51731419 0.51731419\n16 0.85     2     1 0.330708661  0.38906901 0.71977767\n17 0.78     2     1 0.167938931  0.21530632 0.38324525\n   m        CCF   comment\n1  1 0.31562741 Subclonal\n2  1 0.78346085 Subclonal\n3  1 0.35787040 Subclonal\n4  1 0.70834932 Subclonal\n5  1 0.67356019 Subclonal\n6  1 0.48352674 Subclonal\n7  1 0.62732589 Subclonal\n8  1 0.01752951 Subclonal",
        "\n9  1 0.00000000        NA\n10 1 0.00000000        NA\n11 1 0.12202563 Subclonal\n12 1 0.18862364 Subclonal\n13 1 0.96753657 Subclonal\n14 1 0.01728086 Subclonal\n15 1 0.51731419 Subclonal\n16 1 0.71977767 Subclonal\n17 1 0.38324525 Subclonal\n",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "data <- data_fig4a %>% dplyr::transmute(",
        "+ ",
        "  intra_patient_prob = archival_summary_matched_patient / archival_summary_tested_patient,",
        "+ ",
        "  inter_patient_prob = archival_summary_matched_control / archival_summary_tested_control,",
        "+ ",
        "  patient_ID = patient_ID",
        "+ ",
        ")",
        "> ",
        "p1 <- ggplot2::ggplot(data) +",
        "+ ",
        "  ggplot2::geom_histogram(ggplot2::aes(x = intra_patient_prob), colour = \"black\", fill = \"blue\", alpha = 0.5, binwidth = 0.02) +",
        "+ ",
        "  ggplot2::ylim(0, 500) +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::xlab(\"Proportion of transition points detected within a patient\") +",
        "+ ",
        "  ggplot2::ylab(\"# Transition points\") +",
        "+ ",
        "  ggplot2::coord_cartesian(xlim = c(0, 1))",
        "> ",
        "p2 <- ggplot2::ggplot(data) +",
        "+ ",
        "  ggplot2::geom_histogram(ggplot2::aes(x = inter_patient_prob), colour = \"black\", fill = \"red\", alpha = 0.5, binwidth = 0.02) +",
        "+ ",
        "  ggplot2::ylim(0, 500) +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::xlab(\"Proportion of transition points detected across patients\") +",
        "+ ",
        "  ggplot2::ylab(\"# Transition points\") +",
        "+ ",
        "  ggplot2::coord_cartesian(xlim = c(0, 1))",
        "> ",
        "gridExtra::grid.arrange(p1, p2)",
        "> ",
        "p <- ggplot2::ggplot(data) +",
        "+ ",
        "  ggplot2::geom_point(ggplot2::aes(intra_patient_prob, inter_patient_prob, fill = patient_ID), size = 3.5, alpha = 0.3, pch = 21) +",
        "+ ",
        "  ggplot2::ylim(0, 1) +",
        "+ ",
        "  ggplot2::theme_bw() +",
        "+ ",
        "  ggplot2::xlab(\"Intra-patient proportion of samples with shared TPs\") +",
        "+ ",
        "  ggplot2::ylab(\"Inter-patient proportion of samples with shared TPs\") +",
        "+ ",
        "  ggplot2::labs(fill = \"Patient IDs\") +",
        "+ ",
        "  ggplot2::theme(legend.position = \"left\")",
        "> ",
        "ggExtra::ggMarginal(p, type = \"density\", fill = \"grey\", alpha = 0.5)",
        "> ",
        "ggExtra::ggMarginal(p, type = \"histogram\", fill = \"cadetblue\", alpha = 0.5)",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "ggplot2::ggplot(data = data_fig4b) +",
        "+ ",
        "  ggplot2::geom_line(ggplot2::aes(Common_TPs, CA34, colour = \"CA34\"), linewidth = 1) +",
        "+ ",
        "  ggplot2::geom_line(ggplot2::aes(Common_TPs, CA36, colour = \"CA36\"), linewidth = 1) +",
        "+ ",
        "  ggplot2::geom_line(ggplot2::aes(Common_TPs, CA76, colour = \"CA76\"), linewidth = 1) +",
        "+ ",
        "  ggplot2::geom_line(ggplot2::aes(Common_TPs, CA83, colour = \"CA83\"), linewidth = 1) +",
        "+ ",
        "  ggplot2::geom_line(ggplot2::aes(Common_TPs, PEA172, colour = \"PEA172\"), linewidth = 1) +",
        "+ ",
        "  ggplot2::theme_bw() +",
        "+ ",
        "  ggplot2::scale_x_reverse(breaks = c(25, 20, 15, 10, 5, 1)) +",
        "+ ",
        "  ggplot2::scale_color_manual(",
        "+ ",
        "    name = \"Patients\",",
        "+ ",
        "    values = c(",
        "+ ",
        "      \"CA34\" = \"black\",",
        "+ ",
        "      \"CA36\" = \"orange\",",
        "+ ",
        "      \"CA76\" = \"purple\",",
        "+ ",
        "      \"CA83\" = \"red\",",
        "+ ",
        "      \"PEA172\" = \"skyblue\"",
        "+ ",
        "    )",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::xlab(\"Number of autopsy samples\") +",
        "+ ",
        "  ggplot2::ylab(\"Percent of plasma TPs found in autopsy cores\") +",
        "+ ",
        "  ggplot2::ggtitle(\"Plasma to metastases comparison of TPs\")",
        "Warning messages:\n",
        "1: \u001B[38;5;255mRemoved 15 rows containing missing values (`geom_line()`).\u001B[39m \n",
        "2: \u001B[38;5;255mRemoved 14 rows containing missing values (`geom_line()`).\u001B[39m \n",
        "3: \u001B[38;5;255mRemoved 7 rows containing missing values (`geom_line()`).\u001B[39m \n",
        "> ",
        "",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "data_fig4c %>%",
        "+ ",
        "  reshape2::melt() %>%",
        "+ ",
        "  ggplot2::ggplot() +",
        "+ ",
        "  ggplot2::geom_bar(ggplot2::aes(x = SampleID_organ, y = value, fill = variable), stat = \"identity\", colour = \"black\", width = .8) +",
        "+ ",
        "  ggplot2::facet_grid(. ~ Breakpoint, scales = \"free\", space = \"free\") +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::theme(",
        "+ ",
        "    axis.text.x = ggplot2::element_text(angle = 90, vjust = 1, hjust = 0.5),",
        "+ ",
        "    panel.spacing = ggplot2::unit(0.5, \"cm\")",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::xlab(\"CA27\") +",
        "+ ",
        "  ggplot2::ylab(\"Number of Transition points\") +",
        "+ ",
        "  ggplot2::labs(fill = \"\") +",
        "+ ",
        "  ggplot2::scale_fill_manual(values = c(\"#e28743\", \"#76b5c5\", \"#154c79\"))",
        "Using cluster, SampleID_organ, Breakpoint as id variables\n",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "Warning message:\n",
        "replacing previous import ‘Biostrings::translate’ by ‘seqinr::translate’ when loading ‘dndscv’ \n",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "dndsout <- dndscv::dndscv(clonal_mutations) %>% suppressWarnings()",
        "[1] Loading the environment...\n",
        "[2] Annotating the mutations...\n",
        "    Note: 30 mutations removed for exceeding the limit of mutations per gene per sample (see the max_muts_per_gene_per_sample argument in dndscv)\n",
        "[3] Estimating global rates...\n",
        "[4] Running dNdSloc...\n",
        "[5] Running dNdScv...\n",
        "    Regression model for substitutions (theta = 0.0202).\n",
        "> ",
        "mutation_position_tib <- dndsout$annotmuts %>%",
        "+ ",
        "  dplyr::filter((impact != \"Synonymous\")) %>%",
        "+ ",
        "  dplyr::group_by(sampleID) %>%",
        "+ ",
        "  dplyr::transmute(chr_pos = paste0(chr, \"_\", pos)) %>%",
        "+ ",
        "  dplyr::summarise_all(., list) %>%",
        "+ ",
        "  dplyr::mutate(cm_number = purrr::map_int(.x = chr_pos, .f = ~ {",
        "+ ",
        "    .x %>% length()",
        "+ ",
        "  })) %>%",
        "+ ",
        "  tidyr::separate(col = sampleID, into = c(\"patientID\", \"sample\"), sep = \"_\", remove = F) %>%",
        "+ ",
        "  dplyr::select(-sample) %>%",
        "+ ",
        "  dplyr::group_by(patientID) %>%",
        "+ ",
        "  tidyr::nest()",
        "> ",
        "func_pct_common <- function(sample_tibble) {",
        "+ ",
        "  res_list <- purrr::map(",
        "+ ",
        "    .x = combn(sample_tibble$sampleID, 2, simplify = F),",
        "+ ",
        "    .f = ~ {",
        "+ ",
        "      (sample_tibble %>%",
        "+ ",
        "        dplyr::filter(sampleID %in% .x) %>%",
        "+ ",
        "        dplyr::pull(chr_pos) %>%",
        "+ ",
        "        Reduce(intersect, .) %>%",
        "+ ",
        "        length()) / (sample_tibble %>%",
        "+ ",
        "        dplyr::filter(sampleID %in% .x) %>%",
        "+ ",
        "        dplyr::pull(cm_number) %>%",
        "+ ",
        "        Reduce(min, .)) * 100",
        "+ ",
        "    }",
        "+ ",
        "  )",
        "+ ",
        "  names(res_list) <- purrr::map(.x = combn(sample_tibble$sampleID, 2, simplify = F), .f = ~ paste(.x, collapse = \" \"))",
        "+ ",
        "",
        "+ ",
        "  return(do.call(rbind, res_list) %>% data.frame(pct_common = .))",
        "+ ",
        "}",
        "> ",
        "percent_common <- purrr::map(",
        "+ ",
        "  .x = mutation_position_tib %>% dplyr::pull(data),",
        "+ ",
        "  .f = func_pct_common",
        "+ ",
        ") %>%",
        "+ ",
        "  do.call(rbind, .)",
        "> ",
        "df_stat <- percent_common %>%",
        "+ ",
        "  as.data.frame() %>%",
        "+ ",
        "  merge(., correlation_distances, by = \"row.names\", all = T) %>%",
        "+ ",
        "  dplyr::select(-Row.names)",
        "> ",
        "p <- ggpubr::ggboxplot(df_stat, x = \"within_same_cluster\", y = \"pct_common\", fill = \"within_same_cluster\") +",
        "+ ",
        "  ggplot2::xlab(\"Within same cluster?\") +",
        "+ ",
        "  ggplot2::ylab(\"% common clonal non-silent mutations\") +",
        "+ ",
        "  ggplot2::labs(fill = \"Within same cluster?\")",
        "> ",
        "p + ggpubr::stat_compare_means(method = \"t.test\")",
        "> ",
        "label <- paste(\"italic(R)^2==\", (lm(pct_common ~ distance, data = df_stat) %>% summary())$r.squared %>% round(2))",
        "> ",
        "plt <- ggplot2::ggplot(df_stat, ggplot2::aes(distance, pct_common, label = intersection)) +",
        "+ ",
        "  ggplot2::geom_point(ggplot2::aes(fill = within_same_cluster), size = 4, pch = 21) +",
        "+ ",
        "  ggplot2::geom_smooth(ggplot2::aes(distance, pct_common), method = \"lm\") +",
        "+ ",
        "  ggplot2::xlab(\"Correlation distance\") +",
        "+ ",
        "  ggplot2::ylab(\"% common clonal non-silent mutations\") +",
        "+ ",
        "  ggplot2::theme_bw() +",
        "+ ",
        "  ggplot2::annotate(\"text\", x = 0.5, y = 90, label = label, parse = T) +",
        "+ ",
        "  ggplot2::labs(fill = \"Within same cluster?\")",
        "> ",
        "suppressWarnings(print(plt))",
        "\u001B[38;5;255m`geom_smooth()` using formula = 'y ~ x'\u001B[39m\n",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "draw_tanglegram <- function(tree_1, tree_2, C.Index, p.value, patientID) {",
        "+ ",
        "  dendextend::dendlist(",
        "+ ",
        "    tree_1 %>%",
        "+ ",
        "      dendextend::set(\"branches_lwd\", 3) %>%",
        "+ ",
        "      dendextend::set(\"branches_col\", \"salmon\"),",
        "+ ",
        "    tree_2 %>%",
        "+ ",
        "      dendextend::set(\"branches_lwd\", 3) %>%",
        "+ ",
        "      dendextend::set(\"branches_col\", \"cadetblue\")",
        "+ ",
        "  ) %>%",
        "+ ",
        "    dendextend::untangle(method = \"step2side\") %>%",
        "+ ",
        "    dendextend::tanglegram(",
        "+ ",
        "      common_subtrees_color_lines = T,",
        "+ ",
        "      highlight_distinct_edges = FALSE,",
        "+ ",
        "      highlight_branches_lwd = F,",
        "+ ",
        "      margin_inner = 3,",
        "+ ",
        "      lwd = 3,",
        "+ ",
        "      color = \"darkgrey\",",
        "+ ",
        "      main_left = \"Autosomal\",",
        "+ ",
        "      cex_main_left = 1,",
        "+ ",
        "      main_right = \"ChrX-based\",",
        "+ ",
        "      cex_main_right = 1,",
        "+ ",
        "      main = paste0(",
        "+ ",
        "        patientID, \"\\n Baker's Gamma index = \",",
        "+ ",
        "        dendextend::cor_bakers_gamma(tree_1, tree_2) %>% round(2),",
        "+ ",
        "        \"\\n Congruence Index = \",",
        "+ ",
        "        C.Index,",
        "+ ",
        "        \"; P-value = \",",
        "+ ",
        "        p.value",
        "+ ",
        "      ),",
        "+ ",
        "      cex_main = 0.7",
        "+ ",
        "    )",
        "+ ",
        "}",
        "> ",
        "phylogram::write.dendrogram(autosomal_tree_CA63, edges = F)",
        "[1] \"(((((((((4,6),34),36),(35,16)),(7,(17,(18,19)))),((5,20),(38,9))),(((8,(37,32)),21),10)),((3,39),33)),((2,15),(((12,((13,((14,28),30)),((24,27),(26,(29,31))))),25),11)));\"\n",
        "> ",
        "phylogram::write.dendrogram(chrX_tree_CA63, edges = F)",
        "[1] \"((((((4,(33,10)),((8,(37,5)),32)),20),((7,3),(((17,(((6,34),(36,35)),16)),(18,19)),21))),(39,(38,9))),((2,(15,(27,(28,(31,30))))),((12,(13,(14,(24,(25,(26,29)))))),11)));\"\n",
        "> ",
        "phylogram::write.dendrogram(autosomal_tree_PEA172, edges = F)",
        "[1] \"((((((6,8),((16,32),33)),30),((21,((15,20),(24,22))),(28,(13,27)))),4),(((((((29,25),((26,9),2)),1),31),3),5),23));\"\n",
        "> ",
        "phylogram::write.dendrogram(chrX_tree_PEA172, edges = F)",
        "[1] \"((((((6,(21,(28,(24,16)))),(15,(22,32))),8),30),(((20,27),33),13)),((((((29,((25,1),(26,2))),5),(31,9)),23),3),4));\"\n",
        "> ",
        "draw_tanglegram(autosomal_tree_CA63, chrX_tree_CA63, 2.05, 3.07e-08, patientID = \"CA63\")",
        "> ",
        "draw_tanglegram(autosomal_tree_PEA172, chrX_tree_PEA172, 1.50, 0.00064, patientID = \"PEA172\")",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "filter_low_count_gene <- function(mat,",
        "+ ",
        "                                  min_counts = 10L,",
        "+ ",
        "                                  min_cells_pc = 0.90) {",
        "+ ",
        "  n_genes_before <- dim(mat)[[1]]",
        "+ ",
        "  min_cells <- floor(dim(mat)[[2]] * min_cells_pc)",
        "+ ",
        "  keep_genes <- apply(mat, 1, function(x) {",
        "+ ",
        "    length(x[x >= min_counts]) > min_cells",
        "+ ",
        "  })",
        "+ ",
        "  mat <- mat[keep_genes, ]",
        "+ ",
        "",
        "+ ",
        "  return(mat)",
        "+ ",
        "}",
        "> ",
        "count_data <- read.csv(\"~/Desktop/test/latest_500kb_run_30Nov21/Manuscript for Charlie Swanton/Nat_Comm/resumission/Final submission/count_data.csv\", row.names = 1)",
        "> ",
        "meta_data_RNAseq <- read.csv(\"~/Desktop/test/latest_500kb_run_30Nov21/Manuscript for Charlie Swanton/Nat_Comm/resumission/Final submission/meta_data_RNAseq.csv\", row.names = 1)",
        "> ",
        "low_count_filtered_exprMat <- filter_low_count_gene(count_data %>% dplyr::select(meta_data_RNAseq$sample_ID) %>% as.matrix())",
        "> ",
        "exprMat_norm <- (limma::voom(low_count_filtered_exprMat, normalize.method = \"quantile\"))$E %>%",
        "+ ",
        "  data.frame() %>%",
        "+ ",
        "  dplyr::mutate(hgnc = rownames(.)) %>%",
        "+ ",
        "  dplyr::filter(hgnc %in% c(\"AR\", hieronymus_geneset$gene))",
        "> ",
        "exprMat_norm_scaled <- exprMat_norm %>%",
        "+ ",
        "  dplyr::select(-hgnc) %>%",
        "+ ",
        "  t() %>%",
        "+ ",
        "  data.frame() %>%",
        "+ ",
        "  purrr::modify(., ~ {",
        "+ ",
        "    (.x - mean(.x)) / sd(.x)",
        "+ ",
        "  }) %>%",
        "+ ",
        "  t() %>%",
        "+ ",
        "  data.frame()",
        "> ",
        "colnames(exprMat_norm_scaled) <- colnames(exprMat_norm)[1:(ncol(exprMat_norm) - 1)]",
        "> ",
        "up_AR_genes_exprMat_norm_scaled <- exprMat_norm_scaled[-3, ] %>%",
        "+ ",
        "  dplyr::filter(rownames(exprMat_norm_scaled[-3, ]) %in% (hieronymus_geneset %>%",
        "+ ",
        "    dplyr::filter(expression == \"up\") %>%",
        "+ ",
        "    dplyr::select(gene) %>% unlist())) %>%",
        "+ ",
        "  purrr::modify(., ~ {",
        "+ ",
        "    ifelse(.x > 1, 1, ifelse(((.x < 1) & (.x > -1)), 0, -1))",
        "+ ",
        "  })",
        "> ",
        "down_AR_genes_exprMat_norm_scaled <- exprMat_norm_scaled[-3, ] %>%",
        "+ ",
        "  dplyr::filter(rownames(exprMat_norm_scaled[-3, ]) %in% (hieronymus_geneset %>%",
        "+ ",
        "    dplyr::filter(expression == \"down\") %>%",
        "+ ",
        "    dplyr::select(gene) %>% unlist())) %>%",
        "+ ",
        "  purrr::modify(., ~ {",
        "+ ",
        "    ifelse(.x < -1, 1, ifelse(((.x > -1) & (.x < 1)), 0, -1))",
        "+ ",
        "  })",
        "> ",
        "exprMat_AR_score <- dplyr::bind_rows(up_AR_genes_exprMat_norm_scaled, down_AR_genes_exprMat_norm_scaled) %>%",
        "+ ",
        "  colSums(na.rm = T) %>%",
        "+ ",
        "  reshape2::melt() %>%",
        "+ ",
        "  dplyr::select(AR_score = value) %>%",
        "+ ",
        "  dplyr::mutate(sample_ID = rownames(.))",
        "> ",
        "plot_data <- dplyr::left_join(meta_data_RNAseq, exprMat_AR_score, by = \"sample_ID\") %>%",
        "+ ",
        "  dplyr::left_join(.,",
        "+ ",
        "    exprMat_norm_scaled[\"AR\", ] %>%",
        "+ ",
        "      t() %>%",
        "+ ",
        "      data.frame() %>%",
        "+ ",
        "      dplyr::mutate(sample_ID = rownames(.)),",
        "+ ",
        "    by = \"sample_ID\"",
        "+ ",
        "  ) %>%",
        "+ ",
        "  dplyr::filter(TC >= 0.2)",
        "> ",
        "ggplot2::ggplot(",
        "+ ",
        "  data = plot_data,",
        "+ ",
        "  ggplot2::aes(x = AR, y = AR_score)",
        "+ ",
        ") +",
        "+ ",
        "  ggplot2::geom_point(pch = 21, ggplot2::aes(fill = patient_ID, size = AR_copy_number_ACE)) +",
        "+ ",
        "  ggplot2::geom_smooth(method = \"lm\", se = F, ggplot2::aes(colour = patient_ID), show.legend = F) +",
        "+ ",
        "  ggplot2::labs(",
        "+ ",
        "    x = \"Normalized AR expression\",",
        "+ ",
        "    y = \"AR score\", size = \"AR CN\", fill = \"patient ID\"",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::theme_bw()",
        "\u001B[38;5;255m`geom_smooth()` using formula = 'y ~ x'\u001B[39m\n",
        "> ",
        "plot_data %>%",
        "+ ",
        "  dplyr::group_by(patient_ID) %>%",
        "+ ",
        "  tidyr::nest() %>%",
        "+ ",
        "  dplyr::mutate(",
        "+ ",
        "    model = purrr::map(.x = data, .f = ~ cor.test(.x$AR_score, .x$AR)),",
        "+ ",
        "    tidied = purrr::map(model, .f = broom::tidy)",
        "+ ",
        "  ) %>%",
        "+ ",
        "  tidyr::unnest(tidied) %>%",
        "+ ",
        "  dplyr::arrange(patient_ID) %>%",
        "+ ",
        "  dplyr::select(patient_ID, estimate, p.value)",
        "\u001B[38;5;246m# A tibble: 4 × 3\u001B[39m\n\u001B[38;5;246m# Groups:   patient_ID [4]\u001B[39m\n  patient_ID estimate p.value\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m   \u001B[3m\u001B[38;5;246m<dbl>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m CA63         0.499  0.208  \n\u001B[38;5;250m2\u001B[39m CA76         0.312  0.452  \n\u001B[38;5;250m3\u001B[39m CA83         0.095\u001B[4m5\u001B[24m 0.904  \n\u001B[38;5;250m4\u001B[39m PEA172       0.626  0.003\u001B[4m1\u001B[24m\u001B[4m3\u001B[24m\n",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "ggplot2::ggplot(data = ARV12mimic, ggplot2::aes(x = clusterID, y = AR_norm)) +",
        "+ ",
        "  ggplot2::geom_jitter(width = 0.1, ggplot2::aes(fill = ARV12mimic), size = 4, pch = 21) +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::xlab(\"SCRATCH cluster\") +",
        "+ ",
        "  ggplot2::ylab(\"Normalized AR expression\") +",
        "+ ",
        "  ggplot2::scale_fill_discrete(name = \"AR-V12 mimics\")",
        "> ",
        "View(covs)",
        "> ",
        "View(correlation_distances)",
        "> ",
        "mutation_position_tib",
        "\u001B[38;5;246m# A tibble: 9 × 2\u001B[39m\n\u001B[38;5;246m# Groups:   patientID [9]\u001B[39m\n  patientID data            \n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<list>\u001B[39m\u001B[23m          \n\u001B[38;5;250m1\u001B[39m CA34      \u001B[38;5;246m<tibble [2 × 3]>\u001B[39m\n\u001B[38;5;250m2\u001B[39m CA35      \u001B[38;5;246m<tibble [3 × 3]>\u001B[39m\n\u001B[38;5;250m3\u001B[39m CA36      \u001B[38;5;246m<tibble [2 × 3]>\u001B[39m\n\u001B[38;5;250m4\u001B[39m CA43      \u001B[38;5;246m<tibble [2 × 3]>\u001B[39m\n\u001B[38;5;250m5\u001B[39m CA63      \u001B[38;5;246m<tibble [6 × 3]>\u001B[39m\n\u001B[38;5;250m6\u001B[39m CA76      \u001B[38;5;246m<tibble [2 × 3]>\u001B[39m\n",
        "\u001B[38;5;250m7\u001B[39m CA79      \u001B[38;5;246m<tibble [2 × 3]>\u001B[39m\n\u001B[38;5;250m8\u001B[39m CA83      \u001B[38;5;246m<tibble [2 × 3]>\u001B[39m\n\u001B[38;5;250m9\u001B[39m PEA172    \u001B[38;5;246m<tibble [3 × 3]>\u001B[39m\n",
        "> ",
        "mutation_position_tib$data",
        "[[1]]\n\u001B[38;5;246m# A tibble: 2 × 3\u001B[39m\n  sampleID chr_pos    cm_number\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<list>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<int>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m CA34_10  \u001B[38;5;246m<chr [41]>\u001B[39m        41\n\u001B[38;5;250m2\u001B[39m CA34_5   \u001B[38;5;246m<chr [26]>\u001B[39m        26\n\n[[2]]\n\u001B[38;5;246m# A tibble: 3 × 3\u001B[39m\n  sampleID chr_pos    cm_number\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<list>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<int>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m CA35_1   \u001B[38;5;246m<chr [33]>\u001B[39m        33\n",
        "\u001B[38;5;250m2\u001B[39m CA35_5   \u001B[38;5;246m<chr [34]>\u001B[39m        34\n\u001B[38;5;250m3\u001B[39m CA35_6   \u001B[38;5;246m<chr [38]>\u001B[39m        38\n\n[[3]]\n\u001B[38;5;246m# A tibble: 2 × 3\u001B[39m\n  sampleID chr_pos     cm_number\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<list>\u001B[39m\u001B[23m          \u001B[3m\u001B[38;5;246m<int>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m CA36_10  \u001B[38;5;246m<chr [30]>\u001B[39m         30\n\u001B[38;5;250m2\u001B[39m CA36_3   \u001B[38;5;246m<chr [109]>\u001B[39m       109\n\n[[4]]\n\u001B[38;5;246m# A tibble: 2 × 3\u001B[39m\n  sampleID chr_pos    cm_number\n",
        "  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<list>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<int>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m CA43_5   \u001B[38;5;246m<chr [57]>\u001B[39m        57\n\u001B[38;5;250m2\u001B[39m CA43_8   \u001B[38;5;246m<chr [51]>\u001B[39m        51\n\n[[5]]\n\u001B[38;5;246m# A tibble: 6 × 3\u001B[39m\n  sampleID chr_pos    cm_number\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<list>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<int>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m CA63_13  \u001B[38;5;246m<chr [44]>\u001B[39m        44\n\u001B[38;5;250m2\u001B[39m CA63_15  \u001B[38;5;246m<chr [53]>\u001B[39m        53\n",
        "\u001B[38;5;250m3\u001B[39m CA63_16  \u001B[38;5;246m<chr [82]>\u001B[39m        82\n\u001B[38;5;250m4\u001B[39m CA63_2   \u001B[38;5;246m<chr [53]>\u001B[39m        53\n\u001B[38;5;250m5\u001B[39m CA63_3   \u001B[38;5;246m<chr [47]>\u001B[39m        47\n\u001B[38;5;250m6\u001B[39m CA63_34  \u001B[38;5;246m<chr [50]>\u001B[39m        50\n\n[[6]]\n\u001B[38;5;246m# A tibble: 2 × 3\u001B[39m\n  sampleID chr_pos    cm_number\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<list>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<int>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m CA76_11  \u001B[38;5;246m<chr [30]>\u001B[39m        30\n\u001B[38;5;250m2\u001B[39m CA76_4   \u001B[38;5;246m<chr [67]>\u001B[39m        67\n",
        "\n[[7]]\n\u001B[38;5;246m# A tibble: 2 × 3\u001B[39m\n  sampleID chr_pos    cm_number\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<list>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<int>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m CA79_10  \u001B[38;5;246m<chr [33]>\u001B[39m        33\n\u001B[38;5;250m2\u001B[39m CA79_4   \u001B[38;5;246m<chr [36]>\u001B[39m        36\n\n[[8]]\n\u001B[38;5;246m# A tibble: 2 × 3\u001B[39m\n  sampleID chr_pos    cm_number\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m    \u001B[3m\u001B[38;5;246m<list>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<int>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m CA83_14  \u001B[38;5;246m<chr [43]>\u001B[39m        43\n",
        "\u001B[38;5;250m2\u001B[39m CA83_26  \u001B[38;5;246m<chr [40]>\u001B[39m        40\n\n[[9]]\n\u001B[38;5;246m# A tibble: 3 × 3\u001B[39m\n  sampleID  chr_pos    cm_number\n  \u001B[3m\u001B[38;5;246m<chr>\u001B[39m\u001B[23m     \u001B[3m\u001B[38;5;246m<list>\u001B[39m\u001B[23m         \u001B[3m\u001B[38;5;246m<int>\u001B[39m\u001B[23m\n\u001B[38;5;250m1\u001B[39m PEA172_25 \u001B[38;5;246m<chr [69]>\u001B[39m        69\n\u001B[38;5;250m2\u001B[39m PEA172_28 \u001B[38;5;246m<chr [56]>\u001B[39m        56\n\u001B[38;5;250m3\u001B[39m PEA172_29 \u001B[38;5;246m<chr [50]>\u001B[39m        50\n\n",
        "> ",
        "View(correlation_distances)",
        "> ",
        "# load data:",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "# set the pipe operator",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "# set the color palette:",
        "> ",
        "cbPalette <- c(",
        "+ ",
        "  \"#999999\",",
        "+ ",
        "  \"#E69F00\",",
        "+ ",
        "  \"#56B4E9\",",
        "+ ",
        "  \"#009E73\",",
        "+ ",
        "  \"#F0E442\",",
        "+ ",
        "  \"#0072B2\",",
        "+ ",
        "  \"#D55E00\",",
        "+ ",
        "  \"#CC79A7\"",
        "+ ",
        ")",
        "> ",
        "data <- data_fig3a %>%",
        "+ ",
        "  dplyr::mutate(yAdj = dplyr::case_when(",
        "+ ",
        "    Type == \"BND\" ~ 0.5,",
        "+ ",
        "    Type == \"DUP\" ~ 0.4,",
        "+ ",
        "    Type == \"INV\" ~ 0.3,",
        "+ ",
        "    Type == \"DEL\" ~ 0.2",
        "+ ",
        "  ))",
        "> ",
        "ggplot2::ggplot(data, ggplot2::aes(start, yCoord, colour = Type)) +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66774465, xmax = 66950461, ymin = 0.5, ymax = 25.5, alpha = 0.5, fill = \"salmon\") +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66117800, xmax = 66128800, ymin = 0.5, ymax = 25.5, fill = \"black\") +",
        "+ ",
        "  ggplot2::geom_point(shape = 73, size = 5) +",
        "+ ",
        "  ggplot2::geom_hline(yintercept = c(0.5, data$yCoord + 0.5), colour = \"grey\", linetype = 2, linewidth = 0.3) +",
        "+ ",
        "  ggplot2::scale_colour_manual(values = cbPalette) +",
        "+ ",
        "  ggplot2::scale_x_continuous(",
        "+ ",
        "    name = \"Chromosome X position (Mb)\",",
        "+ ",
        "    limits = c(4.3e7, 8e7),",
        "+ ",
        "    breaks = seq(50e6, 80e6, 1e6),",
        "+ ",
        "    labels = as.character(seq(50, 80))",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::annotate(\"text\", x = 4.4e7, y = data$yCoord, label = data$met, hjust = \"left\") +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::theme(",
        "+ ",
        "    axis.title.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.text.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.ticks.y = ggplot2::element_blank()",
        "+ ",
        "  )",
        "Warning messages:\n",
        "1: \u001B[38;5;255mRemoved 2 rows containing missing values (`geom_point()`).\u001B[39m \n",
        "2: \u001B[38;5;255mRemoved 96 rows containing missing values (`geom_text()`).\u001B[39m \n",
        "\nRestarting R session...\n\n"
    ]
}