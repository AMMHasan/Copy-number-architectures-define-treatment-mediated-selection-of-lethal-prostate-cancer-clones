{
    "type": [
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        3,
        3,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2
    ],
    "data": [
        "\nR version 4.2.2 (2022-10-31) -- \"Innocent and Trusting\"\nCopyright (C) 2022 The R Foundation for Statistical Computing\nPlatform: x86_64-apple-darwin17.0 (64-bit)\n\nR is free software and comes with ABSOLUTELY NO WARRANTY.\nYou are welcome to redistribute it under certain conditions.\nType 'license()' or 'licence()' for distribution details.\n\n  Natural language support but running in an English locale\n\nR is a collaborative project with many contributors.\nType 'contributors()' for more information and\n'citation()' on how to cite R or R packages in publications.\n\n",
        "Type 'demo()' for some demos, 'help()' for on-line help, or\n'help.start()' for an HTML browser interface to help.\nType 'q()' to quit R.\n\n",
        "> ",
        "# load data:",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "# set the pipe operator",
        "Warning message:\n",
        "replacing previous import ‘Biostrings::translate’ by ‘seqinr::translate’ when loading ‘dndscv’ \n",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "# set the color palette:",
        "> ",
        "cbPalette <- c(",
        "+ ",
        "  \"#999999\",",
        "+ ",
        "  \"#E69F00\",",
        "+ ",
        "  \"#56B4E9\",",
        "+ ",
        "  \"#009E73\",",
        "+ ",
        "  \"#F0E442\",",
        "+ ",
        "  \"#0072B2\",",
        "+ ",
        "  \"#D55E00\",",
        "+ ",
        "  \"#CC79A7\"",
        "+ ",
        ")",
        "> ",
        "# plot SVs (start break-points) distribution at the AR locus",
        "> ",
        "ggplot2::ggplot(data, ggplot2::aes(start, yCoord, colour = Type)) +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66774465, xmax = 66950461, ymin = 0.5, ymax = 25.5, alpha = 0.5, fill = \"salmon\") +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66117800, xmax = 66128800, ymin = 0.5, ymax = 25.5, fill = \"black\") +",
        "+ ",
        "  ggplot2::geom_point(shape = 73, size = 5) +",
        "+ ",
        "  ggplot2::geom_hline(yintercept = c(0.5, data$yCoord + 0.5), colour = \"grey\", linetype = 2, linewidth = 0.3) +",
        "+ ",
        "  ggplot2::scale_colour_manual(values = cbPalette) +",
        "+ ",
        "  ggplot2::scale_x_continuous(",
        "+ ",
        "    name = \"Chromosome X position (Mb)\",",
        "+ ",
        "    limits = c(4.3e7, 8e7),",
        "+ ",
        "    breaks = seq(50e6, 80e6, 1e6),",
        "+ ",
        "    labels = as.character(seq(50, 80))",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::annotate(\"text\", x = 4.4e7, y = data$yCoord, label = data$met, hjust = \"left\") +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::theme(",
        "+ ",
        "    axis.title.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.text.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.ticks.y = ggplot2::element_blank()",
        "+ ",
        "  )",
        "\u001B[1m\u001B[33mError\u001B[39m in `ggplot2::ggplot()`:\u001B[22m\n\u001B[38;5;255m\u001B[33m!\u001B[38;5;255m `data` cannot be a function.\n\u001B[36mℹ\u001B[38;5;255m Have you misspelled the `data` argument in `ggplot()`\u001B[39m\n\u001B[90mRun `\u001B]8;;rstudio:run:rlang::last_trace()\u0007rlang::last_trace()\u001B]8;;\u0007` to see where the error occurred.\u001B[39m\n",
        "> ",
        "# load data:",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "# set the pipe operator",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "# set the color palette:",
        "> ",
        "cbPalette <- c(",
        "+ ",
        "  \"#999999\",",
        "+ ",
        "  \"#E69F00\",",
        "+ ",
        "  \"#56B4E9\",",
        "+ ",
        "  \"#009E73\",",
        "+ ",
        "  \"#F0E442\",",
        "+ ",
        "  \"#0072B2\",",
        "+ ",
        "  \"#D55E00\",",
        "+ ",
        "  \"#CC79A7\"",
        "+ ",
        ")",
        "> ",
        "# plot SVs (start break-points) distribution at the AR locus",
        "> ",
        "ggplot2::ggplot(data_fig3a, ggplot2::aes(start, yCoord, colour = Type)) +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66774465, xmax = 66950461, ymin = 0.5, ymax = 25.5, alpha = 0.5, fill = \"salmon\") +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66117800, xmax = 66128800, ymin = 0.5, ymax = 25.5, fill = \"black\") +",
        "+ ",
        "  ggplot2::geom_point(shape = 73, size = 5) +",
        "+ ",
        "  ggplot2::geom_hline(yintercept = c(0.5, data$yCoord + 0.5), colour = \"grey\", linetype = 2, linewidth = 0.3) +",
        "+ ",
        "  ggplot2::scale_colour_manual(values = cbPalette) +",
        "+ ",
        "  ggplot2::scale_x_continuous(",
        "+ ",
        "    name = \"Chromosome X position (Mb)\",",
        "+ ",
        "    limits = c(4.3e7, 8e7),",
        "+ ",
        "    breaks = seq(50e6, 80e6, 1e6),",
        "+ ",
        "    labels = as.character(seq(50, 80))",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::annotate(\"text\", x = 4.4e7, y = data$yCoord, label = data$met, hjust = \"left\") +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::theme(",
        "+ ",
        "    axis.title.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.text.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.ticks.y = ggplot2::element_blank()",
        "+ ",
        "  )",
        "Error in data$yCoord : object of type 'closure' is not subsettable\n",
        "> ",
        "data = data_fig3a",
        "> ",
        "# plot SVs (start break-points) distribution at the AR locus",
        "> ",
        "ggplot2::ggplot(data, ggplot2::aes(start, yCoord, colour = Type)) +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66774465, xmax = 66950461, ymin = 0.5, ymax = 25.5, alpha = 0.5, fill = \"salmon\") +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66117800, xmax = 66128800, ymin = 0.5, ymax = 25.5, fill = \"black\") +",
        "+ ",
        "  ggplot2::geom_point(shape = 73, size = 5) +",
        "+ ",
        "  ggplot2::geom_hline(yintercept = c(0.5, data$yCoord + 0.5), colour = \"grey\", linetype = 2, linewidth = 0.3) +",
        "+ ",
        "  ggplot2::scale_colour_manual(values = cbPalette) +",
        "+ ",
        "  ggplot2::scale_x_continuous(",
        "+ ",
        "    name = \"Chromosome X position (Mb)\",",
        "+ ",
        "    limits = c(4.3e7, 8e7),",
        "+ ",
        "    breaks = seq(50e6, 80e6, 1e6),",
        "+ ",
        "    labels = as.character(seq(50, 80))",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::annotate(\"text\", x = 4.4e7, y = data$yCoord, label = data$met, hjust = \"left\") +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::theme(",
        "+ ",
        "    axis.title.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.text.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.ticks.y = ggplot2::element_blank()",
        "+ ",
        "  )",
        "Warning messages:\n",
        "1: \u001B[38;5;255mRemoved 2 rows containing missing values (`geom_point()`).\u001B[39m \n",
        "2: \u001B[38;5;255mRemoved 96 rows containing missing values (`geom_text()`).\u001B[39m \n",
        "> ",
        "# import data and set y",
        "> ",
        "data <- data_fig3a %>%",
        "+ ",
        "  dplyr::mutate(yAdj = dplyr::case_when(",
        "+ ",
        "    Type == \"BND\" ~ 0.5,",
        "+ ",
        "    Type == \"DUP\" ~ 0.4,",
        "+ ",
        "    Type == \"INV\" ~ 0.3,",
        "+ ",
        "    Type == \"DEL\" ~ 0.2",
        "+ ",
        "  ))",
        "> ",
        "# plot SVs (start break-points) distribution at the AR locus",
        "> ",
        "ggplot2::ggplot(data, ggplot2::aes(start, yCoord, colour = Type)) +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66774465, xmax = 66950461, ymin = 0.5, ymax = 25.5, alpha = 0.5, fill = \"salmon\") +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66117800, xmax = 66128800, ymin = 0.5, ymax = 25.5, fill = \"black\") +",
        "+ ",
        "  ggplot2::geom_point(shape = 73, size = 5) +",
        "+ ",
        "  ggplot2::geom_hline(yintercept = c(0.5, data$yCoord + 0.5), colour = \"grey\", linetype = 2, linewidth = 0.3) +",
        "+ ",
        "  ggplot2::scale_colour_manual(values = cbPalette) +",
        "+ ",
        "  ggplot2::scale_x_continuous(",
        "+ ",
        "    name = \"Chromosome X position (Mb)\",",
        "+ ",
        "    limits = c(4.3e7, 8e7),",
        "+ ",
        "    breaks = seq(50e6, 80e6, 1e6),",
        "+ ",
        "    labels = as.character(seq(50, 80))",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::annotate(\"text\", x = 4.4e7, y = data$yCoord, label = data$met, hjust = \"left\") +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::theme(",
        "+ ",
        "    axis.title.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.text.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.ticks.y = ggplot2::element_blank()",
        "+ ",
        "  )",
        "Warning messages:\n",
        "1: \u001B[38;5;255mRemoved 2 rows containing missing\nvalues (`geom_point()`).\u001B[39m \n",
        "2: \u001B[38;5;255mRemoved 96 rows containing missing\nvalues (`geom_text()`).\u001B[39m \n",
        "\nRestarting R session...\n\n",
        "> ",
        "# load data:",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "# set the pipe operator",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "# set the color palette:",
        "> ",
        "cbPalette <- c(",
        "+ ",
        "  \"#999999\",",
        "+ ",
        "  \"#E69F00\",",
        "+ ",
        "  \"#56B4E9\",",
        "+ ",
        "  \"#009E73\",",
        "+ ",
        "  \"#F0E442\",",
        "+ ",
        "  \"#0072B2\",",
        "+ ",
        "  \"#D55E00\",",
        "+ ",
        "  \"#CC79A7\"",
        "+ ",
        ")",
        "> ",
        "# plot SVs (start break-points) distribution at the AR locus",
        "> ",
        "ggplot2::ggplot(data_fig3a, ggplot2::aes(start, yCoord, colour = Type)) +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66774465, xmax = 66950461, ymin = 0.5, ymax = 25.5, alpha = 0.5, fill = \"salmon\") +",
        "+ ",
        "  ggplot2::annotate(\"rect\", xmin = 66117800, xmax = 66128800, ymin = 0.5, ymax = 25.5, fill = \"black\") +",
        "+ ",
        "  ggplot2::geom_point(shape = 73, size = 5) +",
        "+ ",
        "  ggplot2::geom_hline(yintercept = c(0.5, data_fig3a$yCoord + 0.5), colour = \"grey\", linetype = 2, linewidth = 0.3) +",
        "+ ",
        "  ggplot2::scale_colour_manual(values = cbPalette) +",
        "+ ",
        "  ggplot2::scale_x_continuous(",
        "+ ",
        "    name = \"Chromosome X position (Mb)\",",
        "+ ",
        "    limits = c(4.3e7, 8e7),",
        "+ ",
        "    breaks = seq(50e6, 80e6, 1e6),",
        "+ ",
        "    labels = as.character(seq(50, 80))",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::annotate(\"text\", x = 4.4e7, y = data_fig3a$yCoord, label = data_fig3a$met, hjust = \"left\") +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::theme(",
        "+ ",
        "    axis.title.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.text.y = ggplot2::element_blank(),",
        "+ ",
        "    axis.ticks.y = ggplot2::element_blank()",
        "+ ",
        "  )",
        "Warning messages:\n",
        "1: \u001B[38;5;255mRemoved 2 rows containing missing values (`geom_point()`).\u001B[39m \n",
        "2: \u001B[38;5;255mRemoved 96 rows containing missing values (`geom_text()`).\u001B[39m \n",
        "> ",
        "data_fig4a",
        "          archival_segment archival_segment_side archival_summary_matched_patient\n1      1:1000001-153500000                     E                                0\n2    1:153500001-209000000                     E                               15\n3    1:153500001-209000000                     S                                0\n4    1:209500001-245000000                     E                                0\n5    1:209500001-245000000                     S                               14\n6    1:245000001-248500000",
        "                     S                                0\n7     11:31000001-48000000                     E                               15\n8     11:31000001-48000000                     S                               15\n9       11:500001-31000000                     E                               15\n10   11:55500001-134500000                     S                               15\n11    12:1000001-125000000                     E                                0\n12  12:126000001-133500000                     S",
        "                                0\n13    13:20000001-38500000                     E                               15\n14    13:38500001-61500000                     E                                0\n15    13:38500001-61500000                     S                               15\n16   13:61500001-115169878                     S                                0\n17    15:22000001-32500000                     E                                0\n18   15:33000001-102500000                     S                                0",
        "\n19      16:500001-51000000                     E                               15\n20    16:51000001-90000000                     S                               15\n21     2:1000001-103000000                     E                                0\n22   2:103000001-155000000                     E                                0\n23   2:103000001-155000000                     S                                0\n24   2:155000001-243000000                     S                                0\n25       4:500001-49000000",
        "                     E                               10\n26    4:53000001-190000000                     S                                7\n27   5:101000001-109000000                     E                               11\n28   5:101000001-109000000                     S                               14\n29   5:109000001-172500000                     E                                6\n30   5:109000001-172500000                     S                               11\n31   5:172500001-180500000                     S",
        "                                6\n32     5:25500001-85500000                     E                                2\n33     5:25500001-85500000                     S                                3\n34       5:500001-25500000                     E                                3\n35     5:85500001-97500000                     E                               15\n36     5:85500001-97500000                     S                                2\n37    5:98000001-101000000                     E                               14",
        "\n38    5:98000001-101000000                     S                               15\n39   6:126000001-159500000                     E                                0\n40   6:126000001-159500000                     S                               15\n41   6:159500001-170500000                     S                                0\n42       6:500001-66000000                     E                               15\n43    6:66000001-126000000                     E                               15\n44    6:66000001-126000000",
        "                     S                               15\n45   8:126500001-146364022                     S                                0\n46     8:37000001-66500000                     E                                0\n47     8:37000001-66500000                     S                               15\n48       8:500001-37000000                     E                               15\n49    8:66500001-126500000                     E                                0\n50    8:66500001-126500000                     S",
        "                                0\n51     1:1000001-120500000                     E                               15\n52   1:146500001-209000000                     E                               15\n53   1:146500001-209000000                     S                               15\n54   1:209500001-245000000                     E                                0\n55   1:209500001-245000000                     S                               14\n56   1:245000001-248500000                     S                                0",
        "\n57    11:31000001-48000000                     E                               15\n58    11:31000001-48000000                     S                               15\n59      11:500001-31000000                     E                               15\n60   11:55500001-134500000                     S                               15\n61    12:1000001-126500000                     E                                0\n62  12:126500001-133500000                     S                                0\n63    13:20000001-38500000",
        "                     E                               15\n64    13:38500001-56500000                     E                               15\n65    13:38500001-56500000                     S                               15\n66   13:57000001-115169878                     S                                1\n67      16:500001-51000000                     E                               15\n68    16:51000001-58000000                     E                                0\n69    16:51000001-58000000                     S",
        "                               15\n70    16:58000001-64000000                     E                                0\n71    16:58000001-64000000                     S                                0\n72    16:64000001-90000000                     S                                0\n73     2:1000001-103000000                     E                                0\n74   2:103000001-155000000                     E                                0\n75   2:103000001-155000000                     S                                0",
        "\n76   2:155000001-243000000                     S                                0\n77       4:500001-49000000                     E                               10\n78    4:53000001-190000000                     S                                7\n79   5:101000001-109000000                     E                               11\n80   5:101000001-109000000                     S                               14\n81   5:109000001-172500000                     E                                6\n82   5:109000001-172500000",
        "                     S                               11\n83   5:172500001-180500000                     S                                6\n84     5:25000001-85500000                     E                                2\n85     5:25000001-85500000                     S                                3\n86       5:500001-25000000                     E                                3\n87     5:85500001-97500000                     E                               15\n88     5:85500001-97500000                     S",
        "                                2\n89    5:98000001-101000000                     E                               14\n90    5:98000001-101000000                     S                               15\n91   6:126000001-159500000                     E                                0\n92   6:126000001-159500000                     S                               15\n93   6:159500001-170500000                     S                                0\n94       6:500001-66000000                     E                               15",
        "\n95    6:66000001-126000000                     E                               15\n96    6:66000001-126000000                     S                               15\n97   8:137000001-146364022                     S                                0\n98     8:36500001-51000000                     E                                0\n99     8:36500001-51000000                     S                               15\n100      8:500001-36500000                     E                               15\n101   8:51500001-136000000",
        "                     E                                0\n102   8:51500001-136000000                     S                                0\n103  X:139000001-155000000                     S                                0\n104    X:2500001-139000000                     E                                0\n105    1:1000001-162000000                     E                                0\n106  1:162000001-208500000                     E                               15\n107  1:162000001-208500000                     S",
        "                                0\n108  1:208500001-245000000                     E                                0\n109  1:208500001-245000000                     S                                1\n110  1:245000001-248500000                     S                                0\n111   11:31000001-48000000                     E                               15\n112   11:31000001-48000000                     S                               15\n113     11:500001-31000000                     E                               15",
        "\n114  11:55500001-134500000                     S                               15\n115   12:1000001-125000000                     E                                0\n116 12:126000001-133500000                     S                                0\n117   13:20000001-38500000                     E                               15\n118   13:38500001-61500000                     E                                0\n119   13:38500001-61500000                     S                               15\n120  13:61500001-115169878",
        "                     S                                0\n121   16:48500001-90000000                     S                                0\n122     16:500001-48500000                     E                                0\n123    2:1000001-103500000                     E                                0\n124  2:103500001-155000000                     E                                0\n125  2:103500001-155000000                     S                                0\n126  2:155000001-243000000                     S",
        "                                0\n127      4:500001-49000000                     E                               10\n128   4:53000001-190000000                     S                                7\n129  5:101000001-180500000                     S                               14\n130    5:28000001-83000000                     E                                0\n131    5:28000001-83000000                     S                                0\n132      5:500001-28000000                     E                                0",
        "\n133    5:83000001-97500000                     E                               15\n134    5:83000001-97500000                     S                                0\n135   5:98000001-101000000                     E                               14\n136   5:98000001-101000000                     S                               15\n137  6:126000001-170500000                     S                               15\n138      6:500001-66000000                     E                               15\n139   6:66000001-126000000",
        "                     E                               15\n140   6:66000001-126000000                     S                               15\n141  8:126500001-146364022                     S                                0\n142    8:36500001-66500000                     E                                0\n    archival_summary_tested_patient archival_summary_matched_control archival_summary_tested_control\n1                                15                                0                             291\n2                                15",
        "                               13                             291\n3                                15                                0                             291\n4                                15                                0                             291\n5                                15                                7                             291\n6                                15                                0                             291\n7                                15                               23",
        "                             291\n8                                15                                2                             291\n9                                15                                2                             291\n10                               15                               23                             291\n11                               15                               23                             291\n12                               15                               20                             291",
        "\n13                               15                                0                             291\n14                               15                                2                             291\n15                               15                                0                             291\n16                               15                                2                             291\n17                               15                                1                             291\n18                               15",
        "                                1                             291\n19                               15                                7                             291\n20                               15                               27                             291\n21                               15                                2                             291\n22                               15                                0                             291\n23                               15                                2",
        "                             291\n24                               15                                0                             291\n25                               15                               44                             291\n26                               15                               34                             291\n27                               15                                0                             291\n28                               15                                1                             291",
        "\n29                               15                                0                             291\n30                               15                                0                             291\n31                               15                                0                             291\n32                               15                               13                             291\n33                               15                                0                             291\n34                               15",
        "                                1                             291\n35                               15                               16                             291\n36                               15                               13                             291\n37                               15                                1                             291\n38                               15                               16                             291\n39                               15                                2",
        "                             291\n40                               15                                6                             291\n41                               15                                2                             291\n42                               15                                6                             291\n43                               15                                6                             291\n44                               15                                6                             291",
        "\n45                               15                                0                             291\n46                               15                                8                             291\n47                               15                                0                             291\n48                               15                                0                             291\n49                               15                                0                             291\n50                               15",
        "                                8                             291\n51                               15                               55                             291\n52                               15                               13                             291\n53                               15                               35                             291\n54                               15                                0                             291\n55                               15                                7",
        "                             291\n56                               15                                0                             291\n57                               15                               23                             291\n58                               15                                2                             291\n59                               15                                2                             291\n60                               15                               23                             291",
        "\n61                               15                                2                             291\n62                               15                               20                             291\n63                               15                                0                             291\n64                               15                                0                             291\n65                               15                                0                             291\n66                               15",
        "                               11                             291\n67                               15                                7                             291\n68                               15                                1                             291\n69                               15                               27                             291\n70                               15                                0                             291\n71                               15                                1",
        "                             291\n72                               15                                0                             291\n73                               15                                2                             291\n74                               15                                0                             291\n75                               15                                2                             291\n76                               15                                0                             291",
        "\n77                               15                               44                             291\n78                               15                               34                             291\n79                               15                                0                             291\n80                               15                                1                             291\n81                               15                                0                             291\n82                               15",
        "                                0                             291\n83                               15                                0                             291\n84                               15                               13                             291\n85                               15                                0                             291\n86                               15                                0                             291\n87                               15                               16",
        "                             291\n88                               15                               13                             291\n89                               15                                1                             291\n90                               15                               16                             291\n91                               15                                2                             291\n92                               15                                6                             291",
        "\n93                               15                                2                             291\n94                               15                                6                             291\n95                               15                                6                             291\n96                               15                                6                             291\n97                               15                                1                             291\n98                               15",
        "                                0                             291\n99                               15                               20                             291\n100                              15                               20                             291\n101                              15                                1                             291\n102                              15                                0                             291\n103                              15                                6",
        "                             291\n104                              15                                8                             291\n105                              15                                2                             291\n106                              15                               17                             291\n107                              15                                2                             291\n108                              15                                0                             291",
        "\n109                              15                               10                             291\n110                              15                                0                             291\n111                              15                               23                             291\n112                              15                                2                             291\n113                              15                                2                             291\n114                              15",
        "                               23                             291\n115                              15                               23                             291\n116                              15                               20                             291\n117                              15                                0                             291\n118                              15                                2                             291\n119                              15                                0",
        "                             291\n120                              15                                2                             291\n121                              15                               27                             291\n122                              15                                5                             291\n123                              15                                2                             291\n124                              15                                0                             291",
        "\n125                              15                                2                             291\n126                              15                                0                             291\n127                              15                               44                             291\n128                              15                               34                             291\n129                              15                                1                             291\n130                              15",
        "                               14                             291\n131                              15                               21                             291\n132                              15                               21                             291\n133                              15                               16                             291\n134                              15                               14                             291\n135                              15                                1",
        "                             291\n136                              15                               16                             291\n137                              15                                6                             291\n138                              15                                6                             291\n139                              15                                6                             291\n140                              15                                6                             291",
        "\n141                              15                                0                             291\n142                              15                                8                             291\n    patient_ID\n1         CA27\n2         CA27\n3         CA27\n4         CA27\n5         CA27\n6         CA27\n7         CA27\n8         CA27\n9         CA27\n10        CA27\n11        CA27\n12        CA27\n13        CA27\n14        CA27\n15        CA27\n16        CA27\n17        CA27\n18        CA27\n19        CA27\n20        CA27",
        "\n21        CA27\n22        CA27\n23        CA27\n24        CA27\n25        CA27\n26        CA27\n27        CA27\n28        CA27\n29        CA27\n30        CA27\n31        CA27\n32        CA27\n33        CA27\n34        CA27\n35        CA27\n36        CA27\n37        CA27\n38        CA27\n39        CA27\n40        CA27\n41        CA27\n42        CA27\n43        CA27\n44        CA27\n45        CA27\n46        CA27\n47        CA27\n48        CA27\n49        CA27\n50        CA27\n51        CA27\n52        CA27\n53        CA27\n54        CA27\n55 ",
        "       CA27\n56        CA27\n57        CA27\n58        CA27\n59        CA27\n60        CA27\n61        CA27\n62        CA27\n63        CA27\n64        CA27\n65        CA27\n66        CA27\n67        CA27\n68        CA27\n69        CA27\n70        CA27\n71        CA27\n72        CA27\n73        CA27\n74        CA27\n75        CA27\n76        CA27\n77        CA27\n78        CA27\n79        CA27\n80        CA27\n81        CA27\n82        CA27\n83        CA27\n84        CA27\n85        CA27\n86        CA27\n87        CA27\n88        CA27\n89        CA27",
        "\n90        CA27\n91        CA27\n92        CA27\n93        CA27\n94        CA27\n95        CA27\n96        CA27\n97        CA27\n98        CA27\n99        CA27\n100       CA27\n101       CA27\n102       CA27\n103       CA27\n104       CA27\n105       CA27\n106       CA27\n107       CA27\n108       CA27\n109       CA27\n110       CA27\n111       CA27\n112       CA27\n113       CA27\n114       CA27\n115       CA27\n116       CA27\n117       CA27\n118       CA27\n119       CA27\n120       CA27\n121       CA27\n122       CA27\n123       CA27\n124",
        "       CA27\n125       CA27\n126       CA27\n127       CA27\n128       CA27\n129       CA27\n130       CA27\n131       CA27\n132       CA27\n133       CA27\n134       CA27\n135       CA27\n136       CA27\n137       CA27\n138       CA27\n139       CA27\n140       CA27\n141       CA27\n142       CA27\n [ reached 'max' / getOption(\"max.print\") -- omitted 510 rows ]\n",
        "> ",
        "# calculate intra- and inter-patient probabilities of having an archival transition point",
        "> ",
        "data <- data_fig4a %>% dplyr::transmute(",
        "+ ",
        "  intra_patient_prob = archival_summary_matched_patient / archival_summary_tested_patient,",
        "+ ",
        "  inter_patient_prob = archival_summary_matched_control / archival_summary_tested_control,",
        "+ ",
        "  patient_ID = patient_ID",
        "+ ",
        ")",
        "> ",
        "head(data_fig4a)",
        "       archival_segment archival_segment_side archival_summary_matched_patient\n1   1:1000001-153500000                     E                                0\n2 1:153500001-209000000                     E                               15\n3 1:153500001-209000000                     S                                0\n4 1:209500001-245000000                     E                                0\n5 1:209500001-245000000                     S                               14\n6 1:245000001-248500000                     S",
        "                                0\n  archival_summary_tested_patient archival_summary_matched_control archival_summary_tested_control\n1                              15                                0                             291\n2                              15                               13                             291\n3                              15                                0                             291\n4                              15                                0                             291",
        "\n5                              15                                7                             291\n6                              15                                0                             291\n  patient_ID\n1       CA27\n2       CA27\n3       CA27\n4       CA27\n5       CA27\n6       CA27\n",
        "> ",
        "head(data)",
        "  intra_patient_prob inter_patient_prob patient_ID\n1          0.0000000         0.00000000       CA27\n2          1.0000000         0.04467354       CA27\n3          0.0000000         0.00000000       CA27\n4          0.0000000         0.00000000       CA27\n5          0.9333333         0.02405498       CA27\n6          0.0000000         0.00000000       CA27\n",
        "> ",
        "dim(data)",
        "[1] 652   3\n",
        "> ",
        "dim(data_fig4a)",
        "[1] 652   7\n",
        "> ",
        "#",
        "> ",
        "p1 <- ggplot2::ggplot(data) +",
        "+ ",
        "  ggplot2::geom_histogram(ggplot2::aes(x = intra_patient_prob), colour = \"black\", fill = \"blue\", alpha = 0.5, binwidth = 0.02) +",
        "+ ",
        "  ggplot2::ylim(0, 500) +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::xlab(\"Proportion of transition points detected within a patient\") +",
        "+ ",
        "  ggplot2::ylab(\"# Transition points\") +",
        "+ ",
        "  ggplot2::coord_cartesian(xlim = c(0, 1))",
        "> ",
        "p2 <- ggplot2::ggplot(data) +",
        "+ ",
        "  ggplot2::geom_histogram(ggplot2::aes(x = inter_patient_prob), colour = \"black\", fill = \"red\", alpha = 0.5, binwidth = 0.02) +",
        "+ ",
        "  ggplot2::ylim(0, 500) +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::xlab(\"Proportion of transition points detected across patients\") +",
        "+ ",
        "  ggplot2::ylab(\"# Transition points\") +",
        "+ ",
        "  ggplot2::coord_cartesian(xlim = c(0, 1))",
        "> ",
        "gridExtra::grid.arrange(p1, p2)",
        "> ",
        "p <- ggplot2::ggplot(data) +",
        "+ ",
        "  ggplot2::geom_point(ggplot2::aes(intra_patient_prob, inter_patient_prob, fill = patient_ID), size = 3.5, alpha = 0.3, pch = 21) +",
        "+ ",
        "  ggplot2::ylim(0, 1) +",
        "+ ",
        "  ggplot2::theme_bw() +",
        "+ ",
        "  ggplot2::xlab(\"Intra-patient proportion of samples with shared TPs\") +",
        "+ ",
        "  ggplot2::ylab(\"Inter-patient proportion of samples with shared TPs\") +",
        "+ ",
        "  ggplot2::labs(fill = \"Patient IDs\") +",
        "+ ",
        "  ggplot2::theme(legend.position = \"left\")",
        "> ",
        "ggExtra::ggMarginal(p, type = \"density\", fill = \"grey\", alpha = 0.5)",
        "> ",
        "ggExtra::ggMarginal(p, type = \"histogram\", fill = \"cadetblue\", alpha = 0.5)",
        "> ",
        "# load data",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "Error in exists(cacheKey, where = .rs.WorkingDataEnv, inherits = FALSE) : \n  invalid first argument\n",
        "Error in assign(cacheKey, frame, .rs.CachedDataEnv) : \n  attempt to use zero-length variable name\n",
        "> ",
        "# set the pipe operator",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "# load data",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "Error in exists(cacheKey, where = .rs.WorkingDataEnv, inherits = FALSE) : \n  invalid first argument\n",
        "Error in assign(cacheKey, frame, .rs.CachedDataEnv) : \n  attempt to use zero-length variable name\n",
        "> ",
        "# set the pipe operator",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "# load data",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "Error in exists(cacheKey, where = .rs.WorkingDataEnv, inherits = FALSE) : \n  invalid first argument\n",
        "Error in assign(cacheKey, frame, .rs.CachedDataEnv) : \n  attempt to use zero-length variable name\n",
        "> ",
        "# load data",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "Error in exists(cacheKey, where = .rs.WorkingDataEnv, inherits = FALSE) : \n  invalid first argument\n",
        "Error in assign(cacheKey, frame, .rs.CachedDataEnv) : \n  attempt to use zero-length variable name\n",
        "\nRestarting R session...\n\n",
        "> ",
        "# load data",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "",
        "> ",
        "# set the pipe operator",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "ggplot2::ggplot(data = data_fig4b) +",
        "+ ",
        "  ggplot2::geom_line(ggplot2::aes(Common_TPs, CA34, colour = \"CA34\"), linewidth = 1) +",
        "+ ",
        "  ggplot2::geom_line(ggplot2::aes(Common_TPs, CA36, colour = \"CA36\"), linewidth = 1) +",
        "+ ",
        "  ggplot2::geom_line(ggplot2::aes(Common_TPs, CA76, colour = \"CA76\"), linewidth = 1) +",
        "+ ",
        "  ggplot2::geom_line(ggplot2::aes(Common_TPs, CA83, colour = \"CA83\"), linewidth = 1) +",
        "+ ",
        "  ggplot2::geom_line(ggplot2::aes(Common_TPs, PEA172, colour = \"PEA172\"), linewidth = 1) +",
        "+ ",
        "  ggplot2::theme_bw() +",
        "+ ",
        "  ggplot2::scale_x_reverse(breaks = c(25, 20, 15, 10, 5, 1)) +",
        "+ ",
        "  ggplot2::scale_color_manual(",
        "+ ",
        "    name = \"Patients\",",
        "+ ",
        "    values = c(",
        "+ ",
        "      \"CA34\" = \"black\",",
        "+ ",
        "      \"CA36\" = \"orange\",",
        "+ ",
        "      \"CA76\" = \"purple\",",
        "+ ",
        "      \"CA83\" = \"red\",",
        "+ ",
        "      \"PEA172\" = \"skyblue\"",
        "+ ",
        "    )",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::xlab(\"Number of autopsy samples\") +",
        "+ ",
        "  ggplot2::ylab(\"Percent of plasma TPs found in autopsy cores\") +",
        "+ ",
        "  ggplot2::ggtitle(\"Plasma to metastases comparison of TPs\")",
        "Warning messages:\n",
        "1: \u001B[38;5;255mRemoved 15 rows containing missing values (`geom_line()`).\u001B[39m \n",
        "2: \u001B[38;5;255mRemoved 14 rows containing missing values (`geom_line()`).\u001B[39m \n",
        "3: \u001B[38;5;255mRemoved 7 rows containing missing values (`geom_line()`).\u001B[39m \n",
        "> ",
        "# load data",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "# set the pipe operator",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "data_fig4c %>%",
        "+ ",
        "  reshape2::melt() %>%",
        "+ ",
        "  ggplot2::ggplot() +",
        "+ ",
        "  ggplot2::geom_bar(ggplot2::aes(x = SampleID_organ, y = value, fill = variable), stat = \"identity\", colour = \"black\", width = .8) +",
        "+ ",
        "  ggplot2::facet_grid(. ~ Breakpoint, scales = \"free\", space = \"free\") +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::theme(",
        "+ ",
        "    axis.text.x = ggplot2::element_text(angle = 90, vjust = 1, hjust = 0.5),",
        "+ ",
        "    panel.spacing = ggplot2::unit(0.5, \"cm\")",
        "+ ",
        "  ) +",
        "+ ",
        "  ggplot2::xlab(\"CA27\") +",
        "+ ",
        "  ggplot2::ylab(\"Number of Transition points\") +",
        "+ ",
        "  ggplot2::labs(fill = \"\") +",
        "+ ",
        "  ggplot2::scale_fill_manual(values = c(\"#e28743\", \"#76b5c5\", \"#154c79\"))",
        "Using cluster, SampleID_organ, Breakpoint as id variables\n",
        "> ",
        "# function for drawing tanglegram for defined trees, Congruence Index and it's p-value and Baker's Gamma Index by patient",
        "Warning message:\n",
        "replacing previous import ‘Biostrings::translate’ by ‘seqinr::translate’ when loading ‘dndscv’ \n",
        "> ",
        "draw_tanglegram <- function(tree_1, tree_2, C.Index, p.value, patientID) {",
        "+ ",
        "  dendextend::dendlist(",
        "+ ",
        "    tree_1 %>%",
        "+ ",
        "      dendextend::set(\"branches_lwd\", 3) %>%",
        "+ ",
        "      dendextend::set(\"branches_col\", \"salmon\"),",
        "+ ",
        "    tree_2 %>%",
        "+ ",
        "      dendextend::set(\"branches_lwd\", 3) %>%",
        "+ ",
        "      dendextend::set(\"branches_col\", \"cadetblue\")",
        "+ ",
        "  ) %>%",
        "+ ",
        "    dendextend::untangle(method = \"step2side\") %>%",
        "+ ",
        "    dendextend::tanglegram(",
        "+ ",
        "      common_subtrees_color_lines = T,",
        "+ ",
        "      highlight_distinct_edges = FALSE,",
        "+ ",
        "      highlight_branches_lwd = F,",
        "+ ",
        "      margin_inner = 3,",
        "+ ",
        "      lwd = 3,",
        "+ ",
        "      color = \"darkgrey\",",
        "+ ",
        "      main_left = \"Autosomal\",",
        "+ ",
        "      cex_main_left = 1,",
        "+ ",
        "      main_right = \"ChrX-based\",",
        "+ ",
        "      cex_main_right = 1,",
        "+ ",
        "      main = paste0(",
        "+ ",
        "        patientID, \"\\n Baker's Gamma index = \",",
        "+ ",
        "        dendextend::cor_bakers_gamma(tree_1, tree_2) %>% round(2),",
        "+ ",
        "        \"\\n Congruence Index = \",",
        "+ ",
        "        C.Index,",
        "+ ",
        "        \"; P-value = \",",
        "+ ",
        "        p.value",
        "+ ",
        "      ),",
        "+ ",
        "      cex_main = 0.7",
        "+ ",
        "    )",
        "+ ",
        "}",
        "> ",
        "phylogram::write.dendrogram(autosomal_tree_CA63, edges = F)",
        "[1] \"(((((((((4,6),34),36),(35,16)),(7,(17,(18,19)))),((5,20),(38,9))),(((8,(37,32)),21),10)),((3,39),33)),((2,15),(((12,((13,((14,28),30)),((24,27),(26,(29,31))))),25),11)));\"\n",
        "> ",
        "phylogram::write.dendrogram(chrX_tree_CA63, edges = F)",
        "[1] \"((((((4,(33,10)),((8,(37,5)),32)),20),((7,3),(((17,(((6,34),(36,35)),16)),(18,19)),21))),(39,(38,9))),((2,(15,(27,(28,(31,30))))),((12,(13,(14,(24,(25,(26,29)))))),11)));\"\n",
        "> ",
        "phylogram::write.dendrogram(autosomal_tree_PEA172, edges = F)",
        "[1] \"((((((6,8),((16,32),33)),30),((21,((15,20),(24,22))),(28,(13,27)))),4),(((((((29,25),((26,9),2)),1),31),3),5),23));\"\n",
        "> ",
        "phylogram::write.dendrogram(chrX_tree_PEA172, edges = F)",
        "[1] \"((((((6,(21,(28,(24,16)))),(15,(22,32))),8),30),(((20,27),33),13)),((((((29,((25,1),(26,2))),5),(31,9)),23),3),4));\"\n",
        "> ",
        "draw_tanglegram(autosomal_tree_CA63, chrX_tree_CA63, 2.05, 3.07e-08, patientID = \"CA63\")",
        "> ",
        "draw_tanglegram(autosomal_tree_PEA172, chrX_tree_PEA172, 1.50, 0.00064, patientID = \"PEA172\")",
        "> ",
        "# load data",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "# set the pipe operator",
        "> ",
        "\"%>%\" <- magrittr::`%>%`",
        "> ",
        "filter_low_count_gene <- function(mat,",
        "+ ",
        "                                  min_counts = 10L,",
        "+ ",
        "                                  min_cells_pc = 0.90) {",
        "+ ",
        "  n_genes_before <- dim(mat)[[1]]",
        "+ ",
        "  min_cells <- floor(dim(mat)[[2]] * min_cells_pc)",
        "+ ",
        "  keep_genes <- apply(mat, 1, function(x) {",
        "+ ",
        "    length(x[x >= min_counts]) > min_cells",
        "+ ",
        "  })",
        "+ ",
        "  mat <- mat[keep_genes, ]",
        "+ ",
        "",
        "+ ",
        "  return(mat)",
        "+ ",
        "}",
        "> ",
        "# load data",
        "> ",
        "load(\"/Users/mahedi/Documents/UCL/scripts/R/Projects/Copy-number-architectures-define-treatment-mediated-selection-of-lethal-prostate-cancer-clones/figure_data.RData\")",
        "> ",
        "# plot the AR",
        "> ",
        "ggplot2::ggplot(data = ARV12mimic, ggplot2::aes(x = clusterID, y = AR_norm)) +",
        "+ ",
        "  ggplot2::geom_jitter(width = 0.1, ggplot2::aes(fill = ARV12mimic), size = 4, pch = 21) +",
        "+ ",
        "  ggplot2::theme_classic() +",
        "+ ",
        "  ggplot2::xlab(\"SCRATCH cluster\") +",
        "+ ",
        "  ggplot2::ylab(\"Normalized AR expression\") +",
        "+ ",
        "  ggplot2::scale_fill_discrete(name = \"AR-V12 mimics\")",
        "\nRestarting R session...\n\n"
    ]
}